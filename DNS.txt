ğŸŒ DNS (Domain Name System)
â¤ DNS is the Internetâ€™s globally distributed, hierarchical, fault-tolerant naming system that maps:
â¤ Human-readable names â†’ Machine-usable network identifiers
â¤ Most commonly: example.com â†’ 93.184.216.34

â¤ But DNS is not just name â†’ IP.
â¤ It is a distributed database with:
    âœ”ï¸ Delegation
    âœ”ï¸ Caching
    âœ”ï¸ Replication
    âœ”ï¸ Eventual consistency


ğŸ” Why DNS Exists (The Core Problem)
â¤ Without DNS:
    âœ”ï¸ You would need to remember IP addresses
    âœ”ï¸ IPs change (cloud, CDNs, failovers)
    âœ”ï¸ Hard-coded IPs donâ€™t scale

â¤ DNS solves:
    âœ”ï¸ Indirection
    âœ”ï¸ Decoupling identity from location
    âœ”ï¸ Dynamic infrastructure
ğŸ‘‰ DNS is to the Internet what symbol tables are to compilers.


ğŸ” DNS Design Goals
DNS was designed to be:
ğŸŒ Globally scalable
ğŸ§± Decentralized
ğŸ§  Cache-friendly
ğŸ” Fault tolerant
ğŸ¢ Eventually consistent
ğŸ‘‰ It explicitly trades strong consistency for availability and speed.


ğŸ” High-Level DNS Architecture
                    Root Servers
                         â”‚
                 TLD Servers (.com)
                         â”‚
           Authoritative Name Servers
                         â”‚
                 IP Address / Records
ğŸ‘‰ DNS is hierarchical, not flat.


ğŸ” Core DNS Components
1ï¸âƒ£ Stub Resolver (Client Side)
â¤ Lives in:
    âœ”ï¸ OS
    âœ”ï¸ Browser
â¤ Sends DNS query
â¤ Has very small cache

2ï¸âƒ£ Recursive Resolver
â¤ Usually provided by:
 âœ”ï¸ ISP
 âœ”ï¸ Google (8.8.8.8)
 âœ”ï¸ Cloudflare (1.1.1.1)
â¤ Does all the heavy lifting
â¤ Caches aggressively
ğŸ‘‰ Recursive resolvers are the workhorses of DNS

3ï¸âƒ£ Root Name Servers
â¤ Top of DNS hierarchy
â¤ Know: Where .com, .org, .in live
â¤ 13 logical root servers (Aâ€“M)
â¤ Backed by hundreds of Anycast instances

4ï¸âƒ£ TLD Name Servers
â¤ Handle:
    âœ”ï¸ .com
    âœ”ï¸ .org
    âœ”ï¸ .in
â¤ Tell:
    âœ”ï¸ Which authoritative server owns the domain

5ï¸âƒ£ Authoritative Name Servers
â¤ Source of truth for a domain
â¤ Owned by:
    âœ”ï¸ Domain owner
    âœ”ï¸ DNS provider
â¤ Return final DNS records


ğŸ” Full DNS Resolution Flow
Letâ€™s resolve: www.example.com
â¤ Step 1ï¸âƒ£: Client â†’ Recursive Resolver
"Give me IP for www.example.com"

â¤ Step 2ï¸âƒ£: Resolver â†’ Root Server
"I donâ€™t know .com, where is it?"

Root replies: Ask .com TLD servers

â¤ Step 3ï¸âƒ£: Resolver â†’ .com TLD
"Where is example.com?"
TLD replies: Ask ns1.example.com

â¤ Step 4ï¸âƒ£: Resolver â†’ Authoritative Server
"What is www.example.com?"
Authoritative replies: 93.184.216.34

â¤ Step 5ï¸âƒ£: Resolver â†’ Client
Returns IP
Caches result


ğŸ” Recursive vs Iterative Queries
â¤ Recursive
    âœ”ï¸ Client expects final answer
    âœ”ï¸ Used by browsers
â¤ Iterative
    âœ”ï¸ Server gives referral
    âœ”ï¸ Used internally by resolvers

ğŸ” DNS Records
DNS stores records, not just IPs.


ğŸ” Common Record Types
| Record | Purpose                 |
| ------ | ----------------------- |
| A      | IPv4 address            |
| AAAA   | IPv6 address            |
| CNAME  | Alias                   |
| MX     | Mail server             |
| TXT    | Verification, SPF, DKIM |
| NS     | Name server             |
| SRV    | Service discovery       |
| PTR    | Reverse DNS             |


ğŸ” CNAME vs A
â¤ A record â†’ Direct mapping
â¤ CNAME â†’ Pointer to another domain
â¤ CDNs heavily rely on CNAME: www.example.com â†’ example.cdn.net

ğŸ” DNS Caching
Where Caching Happens
    âœ”ï¸ Browser
    âœ”ï¸ OS
    âœ”ï¸ Recursive resolver
    âœ”ï¸ CDN (sometimes)


ğŸ” TTL (Time To Live)
â¤ www.example.com â†’ 300 seconds
â¤ Means:
    âœ”ï¸ Cache for 5 minutes
    âœ”ï¸ After that â†’ re-query
â¤ DNS never pushes updates, only expires caches.


ğŸ” DNS Consistency Model
â¤ DNS is eventually consistent:
    âœ”ï¸ Some users get old IP
    âœ”ï¸ Some get new IP
    âœ”ï¸ Depends on TTL expiration
â¤ This is intentional.


ğŸ” DNS and Load Balancing
DNS can return:
    â¤ Multiple IPs
    â¤ Different IPs based on:
        âœ”ï¸ Geography
        âœ”ï¸ Latency
        âœ”ï¸ Health

â¤ Techniques:
    âœ”ï¸ Round-robin DNS
    âœ”ï¸ Geo DNS
    âœ”ï¸ Latency-based DNS
âš ï¸ DNS is not real-time load balancing.


ğŸ” DNS and CDN (Strong Connection)
â¤ DNS is how CDN works: User â†’ DNS â†’ Nearest Edge IP
â¤ CDN providers:
    âœ”ï¸ Dynamically answer DNS queries
    âœ”ï¸ Use Anycast + Geo IP

ğŸ” Anycast and DNS
â¤ Unicast
    âœ”ï¸ One IP â†’ one server
â¤ Anycast
    âœ”ï¸ One IP â†’ many servers
    âœ”ï¸ Network routes to nearest one
â¤ DNS root servers and CDNs use Anycast heavily.


ğŸ” DNS Security
1ï¸âƒ£ DNS Spoofing / Poisoning
â¤ Fake DNS replies
â¤ Redirect traffic

2ï¸âƒ£ DNSSEC
â¤ Cryptographic signing of DNS records
â¤ Ensures authenticity
â¤ Does not encrypt DNS

3ï¸âƒ£ DoH / DoT
â¤ DNS over HTTPS
â¤ DNS over TLS
â¤ Encrypts DNS queries


ğŸ” Reverse DNS
IP â†’ Domain name
ğŸ‘‰ Uses:
    â¤ PTR records
    â¤ Important for:
        âœ”ï¸ Email spam checks
        âœ”ï¸ Logging


ğŸ” DNS Zone Files (Authoritative View)
âœ… Zone file example:
example.com.  300  IN  A     93.184.216.34
www           300  IN  CNAME example.com.


ğŸ” DNS Delegation
DNS uses delegation, not replication.
â¤ Root delegates .com
â¤ .com delegates example.com
â¤ Authority is clearly defined


ğŸ” Failure Handling in DNS
â¤ If Authoritative Server is Down
    âœ”ï¸ Cached responses still served
    âœ”ï¸ Secondary name servers exist

â¤ If Root Server is Down
    âœ”ï¸ Anycast reroutes
    âœ”ï¸ Other roots exist


ğŸ” DNS Performance Characteristics
â¤ Average resolution: 10â€“50 ms
â¤ With cache hit: ~0 ms
â¤ One of the fastest systems on Earth


ğŸ” DNS Limitations
â¤ No push updates
â¤ TTL delays
â¤ Not transactional
â¤ Not strongly consistent


ğŸ” Mental Model
DNS is a globally distributed, hierarchical, cache-first, eventually consistent naming database


ğŸ” DNS vs CDN
| DNS             | CDN              |
| --------------- | ---------------- |
| Name resolution | Content delivery |
| Returns IPs     | Returns data     |
| Control plane   | Data plane       |
| Low traffic     | Massive traffic  |
ğŸ‘‰ DNS decides where to go, CDN serves content.


ğŸ” Real-World DNS Providers
â¤ Route 53
â¤ Cloudflare DNS
â¤ Google DNS
â¤ Akamai DNS

2ï¸âƒ£4ï¸âƒ£ When DNS Becomes Critical
â¤ Multi-region systems
â¤ Failover architectures
â¤ CDNs
â¤ Zero-downtime migrations


ğŸ” Final Insight 
Every web request starts with DNS
If DNS is slow, broken, or misconfigured â€” nothing else matters.